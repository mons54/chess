<div class="app-head mdl-shadow--2dp mdl-cell mdl-cell--12-col">
    <div profile-game player="player2"></div>
</div>

<div class="app-game__content app-element mdl-shadow--2dp mdl-cell mdl-cell--12-col" 
     ng-class="{'app-game--white': orientation == 'white', 'app-game--black': orientation == 'black'}">
    <div ng-repeat="number in numbers" class="app-game__row">
        <div 
            ng-repeat="letter in letters" 
            ng-init="position = letter + number" 
            ng-class="{'last-turn': isLastTurn(position) }" 
            id="{{position}}" 
            class="app-game__box"
            data-game-box>
            <div class="app-game__box-content">
                <span ng-if="game.pieces[position]" class="app-game__piece" piece-draggable data-position="{{ position }}">
                    <img ng-src="../images/game-1/{{ game.pieces[position].name }}-{{ game.pieces[position].color }}.svg"
                         class="app-game__piece-image app__no-drag">
                </span>
            </div>
        </div>
    </div>
</div>

<div class="app-head mdl-shadow--2dp mdl-cell mdl-cell--12-col">
    <div profile-game player="player1"></div>
</div>

<div class="app-game__infos mdl-shadow--2dp mdl-cell mdl-cell--6-col mdl-cell mdl-cell--12-col-tablet">
    <table ng-if="isPlayer()" 
           class="app-table app-table--game-actions">
        <tbody>
            <tr>
                <td>
                    <button ng-disabled="!possibleResign()"
                            show-modal="modal-resign" 
                            class="app-button mdl-button mdl-js-button">
                            {{ 'resign'|translate }}
                    </button>
                </td>
                <td>
                    <button ng-disabled="!possibleOfferDraw()"
                            show-modal="modal-offer-draw" 
                            class="app-button mdl-button mdl-js-button">
                            {{ 'offer_draw'|translate }}
                    </button>
                </td>
                <td>
                    <button ng-disabled="!possibleDraw()"
                            show-modal="modal-possible-draw" 
                            class="app-button mdl-button mdl-js-button">
                            {{ 'draw'|translate }}
                    </button>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<div class="app-game__infos mdl-shadow--2dp mdl-cell mdl-cell--6-col mdl-cell--12-col-tablet">
    <table ng-if="game" 
           class="app-table app-table--game app-table--game-stats mdl-data-table mdl-js-data-table">
        <thead>
            <tr>
                <th></th>
                <th>{{ 'win' | translate }}</th>
                <th>{{ 'draw' | translate }}</th>
                <th>{{ 'lose'|translate }}</th>
                <th>%</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>{{ 'white' | translate }}</td>
                <td>{{ getPoints(game.white, game.black, 1) }}</td>
                <td>{{ getPoints(game.white, game.black, 0.5) }}</td>
                <td>{{ getPoints(game.white, game.black, 0) }}</td>
                <td ng-init="percentage = getPercentage(game.white, game.black)">{{ percentage }}%</td>
            </tr>
            <tr>
                <td>{{ 'black' | translate }}</td>
                <td>{{ getPoints(game.black, game.white, 1) }}</td>
                <td>{{ getPoints(game.black, game.white, 0.5) }}</td>
                <td>{{ getPoints(game.black, game.white, 0) }}</td>
                <td>{{ 100 - percentage }}%</td>
            </tr>
        </tbody>
    </table>
</div>

<div class="app-game__played" ng-if="played.length">
    <div class="app-game__played-head"
         ng-click="togglePlayed()">
        <table class="app-table app-table--game app-table--game-played mdl-data-table mdl-js-data-table">
            <thead>
                <tr>
                    <th class="app-table--game-played-index"></th>
                    <th class="app-table--game-played-white">{{ 'white'|translate }}</th>
                    <th class="app-table--game-played-black">{{ 'black'|translate }}</th>
                </tr>
            </thead>
        </table>
    </div>
    <div class="app-game__played-content"
         ng-show="showPlayed"
         scroll-down="'played'">
        <table class="app-table app-table--game app-table--game-played mdl-data-table mdl-js-data-table">
            <tbody>
                <tr ng-repeat="play in played">
                    <td class="app-table--game-played-index">{{ $index + 1 }}</td>
                    <td class="app-table--game-played-notation app-table--game-played-white" 
                        ng-class="{'app__clickable': play.white.pieces}"
                        ng-click="replay(play.white)">
                        {{ play.white.notation }}
                    </td>
                    <td class="app-table--game-played-time app-table--game-played-white">{{ play.white.time }}'</td>
                    <td class="app-table--game-played-notation app-table--game-played-black" 
                        ng-class="{'app__clickable': game.finish}"
                        ng-click="replay(play.black)">
                        <span ng-if="play.black.notation">{{ play.black.notation }}</span>
                    </td>
                    <td class="app-table--game-played-time app-table--game-played-black">
                        <span ng-if="play.black.time">{{ play.black.time }}'</span>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<div ng-if="isPlayer()">
    <div id="modal-response-draw" 
         class="app-modal app-modal__bg" 
         role="dialog" 
         aria-hidden="true"
         modal-close-bg>
        <div class="app-modal__dialog">
            <div class="app-modal__content">
                <h4 class="app-modal__title">{{ player2.name }} {{ 'offers_a_draw'|translate }} ?</h4>
                <div class="app-modal__actions">
                    <button modal-close 
                            type="reset" 
                            class="mdl-button mdl-button--raised">
                            {{ 'cancel'|translate }}
                    </button>
                    <button modal-close 
                            ng-click="acceptDraw()"
                            type="button" 
                            class="mdl-button mdl-button--raised mdl-button--colored">
                            {{ 'ok'|translate }}
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-possible-draw"
         class="app-modal app-modal__bg" 
         role="dialog" 
         aria-hidden="true">
        <div class="app-modal__dialog">
            <div class="app-modal__content">
                <h4 class="app-modal__title">{{ 'draw'|translate }} ?</h4>
                <div class="app-modal__actions">
                    <button modal-close 
                            type="reset" 
                            class="mdl-button mdl-button--raised">
                            {{ 'cancel'|translate }}
                    </button>
                    <button modal-close 
                            ng-click="acceptDraw()"
                            type="button" 
                            class="mdl-button mdl-button--raised mdl-button--colored">
                            {{ 'ok'|translate }}
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-offer-draw" 
         class="app-modal app-modal__bg" 
         role="dialog" 
         aria-hidden="true"
         modal-close-bg>
        <div class="app-modal__dialog">
            <div class="app-modal__content">
                <h4 class="app-modal__title">{{ 'offer_draw'|translate }} ?</h4>
                <div class="app-modal__actions">
                    <button modal-close 
                            type="reset" 
                            class="mdl-button mdl-button--raised">
                            {{ 'cancel'|translate }}
                    </button>
                    <button modal-close 
                            ng-click="offerDraw()"
                            type="button" 
                            class="mdl-button mdl-button--raised mdl-button--colored">
                            {{ 'ok'|translate }}
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-resign" 
         class="app-modal app-modal__bg" 
         role="dialog" 
         aria-hidden="true"
         modal-close-bg>
        <div class="app-modal__dialog">
            <div class="app-modal__content">
                <h4 class="app-modal__title">{{ 'resign'|translate }} ?</h4>
                <div class="app-modal__actions">
                    <button modal-close 
                            type="reset" 
                            class="mdl-button mdl-button--raised">
                            {{ 'cancel'|translate }}
                    </button>
                    <button modal-close 
                            ng-click="resign()" 
                            type="button" 
                            class="mdl-button mdl-button--raised mdl-button--colored">
                            {{ 'ok'|translate }}
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-promotion" 
         class="app-modal app-modal__bg"
         role="dialog" 
         aria-hidden="true">
        <div class="app-modal__dialog">
            <div class="app-modal__content">
                <div class="app-promotion__icon"
                     ng-repeat="piece in ['queen', 'rook', 'knight', 'bishop']">
                    <div class="app-game__box-content">
                        <a href 
                           class="app-game__icon app-game__icon--{{ piece }}" 
                           modal-close 
                           data-icon="{{ piece }}">
                           <img ng-src="../images/game-1/{{ piece }}-{{ getPlayerColor() }}.svg"
                             class="app-game__piece-image">
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="modal-finish-game" 
     class="app-modal app-modal__bg"
     role="dialog" 
     aria-hidden="true"
     modal-close-bg>
    <div class="app-modal__dialog">
        <div class="app-modal__content app__text-center">
            <a href modal-close class="app-modal__close">
                <i class="material-icons">clear</i>
            </a>
            <h4 class="app-modal__title">{{ 'game_over'|translate }}</h4>
            <h5 class="app-game-over__result-name">{{ game.result.name|translate }}</h5>
            <h6 class="app-game-over__result-winner" ng-if="game.result.value === 1">{{ 'winner'|translate }}: {{ game.white.name }}</h6>
            <h6 class="app-game-over__result-winner" ng-if="game.result.value === 2">{{ 'winner'|translate }}: {{ game.black.name }}</h6>
            <button ng-click="shareResult()"
                    type="button" 
                    class="mdl-button mdl-button--raised mdl-button--colored">
                    {{ 'share'|translate }}
            </button>
        </div>
    </div>
</div>
